#!/usr/bin/env ruby

require "bundler/setup"
require 'thor'
require 'graphql-docs'

class GraphQLDocsCLI < Thor
  include GraphQLDocs

  class_option :verbose, :type => :boolean

  desc "build", "build docs for a graphql API"

  option :filename, :type => :string, :desc => "Filename of the graphql schema"

  option :output_dir, :type => :string, :desc => "Path to output generated docs", :default => File.join(Dir.pwd, 'output')
  option :base_url, :type => :string, :desc => "Base URL for assets and links", :default => ''
  option :delete_output, :type => :boolean, :desc => "Delete the output dir before generating", :default => false

  def build
    if options[:filename].nil?
      puts 'You must provide a filename pointing to a graphql schema'
      exit 1
    end

    GraphQLDocs.build(
        {
            filename: options[:filename],
            output_dir: options[:output_dir],
            delete_output: options[:delete_output],
            base_url: options[:base_url],
        }
    )

  end
end

GraphQLDocsCLI.start(ARGV)